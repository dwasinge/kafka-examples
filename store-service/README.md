# Store Service

## Overview

The Store service uses [Quarkus](https://quarkus.io) and is used to manage store resources. It exposes a REST API that exposes the standard CRUD operations for store resources.

### Data Store

The service is configured to use [Mongo](https://www.mongodb.com/) as its data store.

### Kafka Topic

When a store resource has been created or modified, a StoreEvent will be created and published to the store-events topic in the Kafka instance or cluster.  The inventory service is the consumer of this topic.

## How do I use it?

### Prerequisites

* Java 8
* Apache Maven
* Docker (if using for Mongo)
* A running Mongo instance

#### Starting Mongo using Docker

Assuming docker is installed, run the following command:
```
docker run --name store-mongo -p 27017:27017 -d mongo
```


### Build the application using Maven
```
mvn clean install
```

### Running the application in dev mode

You can run your application in dev mode that enables live coding using:
```
./mvnw quarkus:dev
```

### Packaging and running the application

The application is packageable using `./mvnw package`.
It produces the executable `store-service-1.0-SNAPSHOT-runner.jar` file in `/target` directory.
Be aware that it’s not an _über-jar_ as the dependencies are copied into the `target/lib` directory.

The application is now runnable using `java -jar target/store-service-1.0-SNAPSHOT-runner.jar`.

### Creating a native executable

You can create a native executable using: `./mvnw package -Pnative`.

Or you can use Docker to build the native executable using: `./mvnw package -Pnative -Dquarkus.native.container-build=true`.

You can then execute your binary: `./target/store-service-1.0-SNAPSHOT-runner`

If you want to learn more about building native executables, please consult https://quarkus.io/guides/building-native-image-guide .

## Access the application

To access the application, open the following link in your browser:

`http://localhost:8080`

Swagger UI can be accessed with the following link:

`http://localhost:8080/swagger-ui/`

### Exposed Endpoints

All exposed endpoints and Models can be found using the [swagger api documentation](http://localhost:8080/openapi) or the [swagger-ui page](http://localhost:8080/swagger-ui/).

The current endpoints are as follows:
```
# retrieve all store resources
GET    /stores

# create new store resource
POST   /stores

# create multiple new store resources
POST   /stores/list

# retrieve store resource by store ID
GET    /stores/{storeId}

# update store resource by store ID
PUT    /stores/{storeID}

# delete store resource by store ID
DELETE /stores/{storeId}

```

### Store Resource Model

Store:
{
id	ObjectId{...}
dateClosed	LocalDatestring($date)
dateOpened	LocalDatestring($date)
regionId	integer($int32)
storeId	integer($int32)
}

NOTE: ObjectId is generated by Mongo upon creation

